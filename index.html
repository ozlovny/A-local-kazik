<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>üéÆ –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</title>
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  <script type="text/javascript" src="https://unpkg.com/parse/dist/parse.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: #fff;
      text-align: center;
      padding-top: 40px;
    }
    h1 {
      font-size: 28px;
      margin-bottom: 20px;
    }
    .menu {
      display: flex;
      flex-direction: column;
      gap: 15px;
      max-width: 250px;
      margin: auto;
    }
    .menu a {
      display: block;
      padding: 15px;
      background: #222;
      color: #fff;
      text-decoration: none;
      font-size: 18px;
      border-radius: 8px;
      transition: background 0.3s;
    }
    .menu a:hover {
      background: #ff4444;
    }
    #balance {
      margin-top: 20px;
      font-size: 18px;
    }
    #topup {
      margin-top: 10px;
    }
    input, button {
      padding: 8px;
      font-size: 16px;
      margin: 5px;
      border: none;
      border-radius: 5px;
    }
    button {
      background: #44aa44;
      color: white;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#000a; z-index:999; justify-content:center; align-items:center;">
  <div style="background:#222; padding:20px; border-radius:10px; width:90%; max-width:320px;">
    <h2>üí∏ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</h2>
    <div style="display:flex; justify-content:center; gap:10px; margin-bottom:10px;">
      <button id="btnTon" onclick="selectMethod('ton')" style="background:#44aa44;">TON</button>
      <button id="btnBot" onclick="selectMethod('bot')" style="background:#333;">CryptoBot</button>
    </div>
    <input type="number" id="modalAmount" placeholder="–°—É–º–º–∞ TON" min="0.01" step="0.01" style="width:100%; margin-bottom:10px;">
    <button onclick="confirmTopUp()">‚úÖ –ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
    <button onclick="closeModal()" style="background:#aa4444; margin-top:10px;">‚ùå –û—Ç–º–µ–Ω–∞</button>
    <div id="modalStatus" style="margin-top:10px;"></div>
  </div>
</div>
  <div class="container">
    <div id="ton-connect-button"></div>
    <h1>üéÆ –í—ã–±–µ—Ä–∏ –∏–≥—Ä—É</h1>
    <div class="menu">
      <a href="mines.html">üí£ –ú–∏–Ω—ã</a>
      <a href="crash.html">üöÄ Crash</a>
      <a href="777.html">üé∞ –†—É–ª–µ—Ç–∫–∞</a>
      <button onclick="openModal()">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
    </div>

    <div id="balance">–ë–∞–ª–∞–Ω—Å: 0 Ton</div>
    
  <h2>üì§ –ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥</h2>
<div id="withdraw">
  <input type="text" id="withdrawAddress" placeholder="TON-–∞–¥—Ä–µ—Å" style="width:90%">
  <input type="number" id="withdrawAmount" placeholder="–°—É–º–º–∞ TON" min="1" style="width:90%">
  <button onclick="submitWithdrawal()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
</div>
<div id="withdrawStatus"></div>
  
<script>
  Parse.initialize("D0jI4TXxRawLDpR9lCNdMqYMRpfm30ibbpvvnXZy", "gklqNlqFb1Hm4dd1MoUWFsrcX4gQtMsMGMqnmZjn");
  Parse.serverURL = "https://parseapi.back4app.com";

  async function submitWithdrawal() {
    const address = document.getElementById("withdrawAddress").value.trim();
    const amount = parseInt(document.getElementById("withdrawAmount").value);
    const statusEl = document.getElementById("withdrawStatus");

    if (!address || !amount || amount < 1) {
      statusEl.textContent = "‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ";
      return;
    }

    try {
      const response = await Parse.Cloud.run("submitWithdrawal", { address, amount });
      statusEl.textContent = response;
      document.getElementById("withdrawAddress").value = '';
      document.getElementById("withdrawAmount").value = '';
    } catch (err) {
      statusEl.textContent = typeof err === 'string' ? err : '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–∫–∏';
      console.error(err);
    }
  }
</script>

  <script>
    const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
      manifestUrl: 'https://phenomenal-bubblegum-d6b71e.netlify.app/tonconnect-manifest.json',
      buttonRootId: 'ton-connect-button'
    });

    const recipientAddress = "EQDYXMQCS9pzb_9oFiJjV97si_kNZwh0TU-0UtmFG-bHlqGf";
    let balance = parseInt(localStorage.getItem('balance')) || 0;

    function updateBalance() {
      document.getElementById('balance').textContent = `–ë–∞–ª–∞–Ω—Å: ${balance} Ton`;
      localStorage.setItem('balance', balance);
    }

    async function sendTon() {
      const amount = parseInt(document.getElementById('topupAmount').value);
      if (!amount || amount < 1) return;

      const wallet = tonConnectUI.wallet;
      if (!wallet) {
        alert('‚ùå –ö–æ—à–µ–ª—ë–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω');
        return;
      }

      const transaction = {
        validUntil: Math.floor(Date.now() / 1000) + 60,
        messages: [
          {
            address: recipientAddress,
            amount: (amount * 1e9).toString()
          }
        ]
      };

      try {
        await tonConnectUI.sendTransaction(transaction);
        balance += amount;
        updateBalance();
        alert(`‚úÖ –ü–æ–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ ${amount} TON`);
        document.getElementById('topupAmount').value = '';
      } catch (e) {
        alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ TON');
        console.error(e);
      }
    }

    updateBalance();
  </script>
  <script>
  function openModal() {
  document.getElementById('modal').style.display = 'flex';
  document.getElementById('modalAmount').value = '';
  document.getElementById('modalStatus').textContent = '';
}

function closeModal() {
  document.getElementById('modal').style.display = 'none';
}

async function confirmTopUp() {
  const amount = parseFloat(document.getElementById('modalAmount').value);
  const statusEl = document.getElementById('modalStatus');

  if (!amount || amount < 0.01) {
    statusEl.textContent = '‚ùå –í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –æ—Ç 0.01 TON';
    return;
  }

  if (selectedMethod === 'bot') {
    // –ª–æ–≥–∏–∫–∞ –¥–ª—è CryptoBot
    statusEl.innerHTML = `üîó –û—Ç–∫—Ä–æ–π <a href="https://t.me/CryptoBot?start=ton-${amount}" target="_blank" style="color:#0f0;">CryptoBot</a> –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è`;
    return;
  }

  // –ª–æ–≥–∏–∫–∞ –¥–ª—è TON —á–µ—Ä–µ–∑ TonConnect
  const wallet = tonConnectUI.wallet;
  if (!wallet) {
    statusEl.textContent = '‚ùå –ö–æ—à–µ–ª—ë–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω';
    return;
  }

  const transaction = {
    validUntil: Math.floor(Date.now() / 1000) + 60,
    messages: [
      {
        address: recipientAddress,
        amount: (amount * 1e9).toString()
      }
    ]
  };

  try {
    await tonConnectUI.sendTransaction(transaction);
    balance += amount;
    balance = parseFloat(balance.toFixed(2));
    updateBalance();
    statusEl.textContent = `‚úÖ –ü–æ–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ ${amount.toFixed(2)} TON`;
    setTimeout(closeModal, 1500);
  } catch (e) {
    statusEl.textContent = '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ TON';
    console.error(e);
  }
}
  </script>
  <script>
  let selectedMethod = 'ton'; // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

function openModal() {
  document.getElementById('modal').style.display = 'flex';
  document.getElementById('modalAmount').value = '';
  document.getElementById('modalStatus').textContent = '';
  selectMethod('ton');
}

function closeModal() {
  document.getElementById('modal').style.display = 'none';
}

function selectMethod(method) {
  selectedMethod = method;
  document.getElementById('btnTon').style.background = method === 'ton' ? '#44aa44' : '#333';
  document.getElementById('btnBot').style.background = method === 'bot' ? '#44aa44' : '#333';
}

async function confirmTopUp() {
  const amount = parseFloat(document.getElementById('modalAmount').value);
  const statusEl = document.getElementById('modalStatus');

  if (!amount || amount < 0.01) {
    statusEl.textContent = '‚ùå –í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –æ—Ç 0.01 TON';
    return;
  }

  if (selectedMethod === 'bot') {
    try {
      const response = await fetch("https://testnet-pay.crypt.bot/api/createInvoice", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Crypto-Pay-API-Token": "48020:AAvPCNEZnJw02ua7E1qyuRp7NhKuZMfhSLy"
        },
        body: JSON.stringify({
          asset: "TON",
          amount: amount.toFixed(2),
          description: "–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞",
          payload: "fahillsy",
          allow_comments: false,
          allow_anonymous: false
        })
      });

      const data = await response.json();
      if (data.invoice_url) {
        window.open(data.invoice_url, "_blank");
        statusEl.innerHTML = `üîó <a href="${data.invoice_url}" target="_blank" style="color:#0f0;">–û—Ç–∫—Ä—ã—Ç—å –∏–Ω–≤–æ–π—Å</a>`;
      } else {
        statusEl.textContent = '‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∏–Ω–≤–æ–π—Å';
        console.error(data);
      }
    } catch (err) {
      statusEl.textContent = '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–Ω–≤–æ–π—Å–∞';
      console.error(err);
    }
    return;
  }

  // TON —á–µ—Ä–µ–∑ TonConnect
  const wallet = tonConnectUI.wallet;
  if (!wallet) {
    statusEl.textContent = '‚ùå –ö–æ—à–µ–ª—ë–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω';
    return;
  }

  const transaction = {
    validUntil: Math.floor(Date.now() / 1000) + 60,
    messages: [
      {
        address: recipientAddress,
        amount: (amount * 1e9).toString()
      }
    ]
  };

  try {
    await tonConnectUI.sendTransaction(transaction);
    balance += amount;
    balance = parseFloat(balance.toFixed(2));
    updateBalance();
    statusEl.textContent = `‚úÖ –ü–æ–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ ${amount.toFixed(2)} TON`;
    setTimeout(closeModal, 1500);
  } catch (e) {
    statusEl.textContent = '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ TON';
    console.error(e);
  }
}
  </script>
  


  
</body>
</html>
